"use strict";(self.webpackChunksimplybook_app=self.webpackChunksimplybook_app||[]).push([[15],{1674:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(4848),o=(0,n(1609).memo)((function(e){var t=e.className,n=e.children,o="bg-white shadow-md rounded-xl  ".concat(t);return(0,r.jsx)("div",{className:o,children:n})}));o.displayName="Block";const a=o},9587:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(4848),o=n(640),a=n(1609),s=n(7723),i=(0,a.memo)((function(e){var t=e.label,n=e.context,a=e.help,i=e.error,l=e.reverseLabel,c=void 0!==l&&l,d=e.className,u=void 0===d?"":d,m=e.inputId,p=e.required,f=void 0!==p&&p,y=e.children,b=["flex w-full flex-col",u,"pt-4"].filter(Boolean).join(" "),g=["flex w-full flex-col",c?"flex-col-reverse":""].filter(Boolean).join(" ");return(0,r.jsxs)("div",{className:b,children:[(0,r.jsxs)("div",{className:g,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(o.b,{className:"cursor-pointer pb-1 font-medium text-black text-md",htmlFor:m,children:[t,f&&(0,r.jsxs)("span",{className:"ml-1 text-gray-500 font-normal text-xs",children:["(",(0,s.__)("Required","simplybook"),")"]})]}),a&&(0,r.jsx)("p",{className:"pb-1 text-xs font-light text-gray-600",children:a})]}),y]}),i&&(0,r.jsx)("p",{className:"mt-2 text-xs font-light text-red-600",role:"alert",children:i}),n&&(0,r.jsx)("p",{className:"mt-2 text-xs font-light text-gray-600",children:n})]})}));i.displayName="FieldWrapper";const l=i},8908:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(4848),o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},a=function(e){var t=e.children,n=e.onClick,a=e.btnVariant,s=void 0===a?"secondary":a,i=e.disabled,l=void 0!==i&&i,c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["children","onClick","btnVariant","disabled"]),d="".concat("font-semibold py-2 px-6 rounded-full transition-all duration-200"," ").concat({primary:"bg-secondary text-white hover:bg-secondary-dark",secondary:"bg-tertiary text-white hover:bg-tertiary-dark",tertiary:"border-2 border-tertiary bg-transparent text-black hover:bg-tertiary-light"}[s]," ").concat(l?"opacity-50 cursor-not-allowed":"");return(0,r.jsx)("button",o({onClick:n,className:d,disabled:l},c,{children:t}))};a.displayName="ButtonInput";const s=a},6681:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(1455),o=n.n(r);const a=simplybook.nonce,s=i("site_url");function i(e){let t=simplybook[e];return"https:"!==window.location.protocol||t.includes("https://")||(t=t.replace("http://","https://")),t}i("ajax_url");const l=async(e,t="POST",n={})=>{const r={path:e,method:t,data:n};r.path="simplybook/v1/"+r.path+(s.includes("?")?"&":"?")+"&token="+Math.random().toString(36).substring(2,7),r.data={...n,nonce:a},"GET"===t&&console.log("the request method is not adjusted for GET requests yet. "),console.log("request : ",r);try{return await(async(e,t="POST",n={})=>{const r={path:e,method:t,data:n};return await o()(r)})(r.path,r.method,r.data)}catch(e){((e,t)=>{console.error(`API Error at ${t}:`,e.message||e)})(e,r.path)}}},5071:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(1609);const o=({children:e,className:t="p-5 pt-0"})=>(0,r.createElement)("div",{className:t},e);o.displayName="BlockContent";const a=o},7330:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(1609);const o=({title:e,controls:t})=>(0,r.createElement)("div",{className:"flex items-center justify-between px-5 py-4"},(0,r.createElement)("h2",{className:"text-base font-bold"},e),t);o.displayName="BlockHeading";const a=o},1243:(e,t,n)=>{n.d(t,{A:()=>j});var r=n(1609),o=n(9785),a=n(4848),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},i=(0,r.forwardRef)((function(e,t){var n=e.type,r=void 0===n?"text":n,o=e.className,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["type","className"]);return(0,a.jsx)("input",s({ref:t,type:r,className:"w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:outline-none focus:ring disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-gray-200 ".concat(o||"")},i))}));i.displayName="TextInput";const l=i;var c=n(9587);n(5150);const d=(0,r.forwardRef)((({field:e,fieldState:t,label:n,help:o,context:a,className:s,...i},d)=>{const u=i.id||e.name;return(0,r.createElement)(c.A,{label:n,help:o,error:t?.error?.message,context:a,className:s,inputId:u,required:i.required},(0,r.createElement)(l,{id:u,type:"text","aria-invalid":!!t?.error?.message,...e,...i}))}));d.displayName="TextField";const u=d;var m=function(){return m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},p=(0,r.forwardRef)((function(e,t){e.type,e.className;var n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["type","className"]);return(0,a.jsx)("input",m({ref:t,type:"hidden"},n))}));p.displayName="HiddenInput";const f=p,y=(0,r.forwardRef)((({field:e,fieldState:t,label:n,help:o,context:a,className:s,...i},l)=>{const c=i.id||e.name;return(0,r.createElement)(f,{...e,id:c,type:"hidden","aria-invalid":!!t?.error?.message,...i})}));y.displayName="HiddenField";const b=y;var g=function(){return g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)},h=(0,r.forwardRef)((function(e,t){var n=e.type,r=void 0===n?"checkbox":n,o=e.className,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["type","className"]);return(0,a.jsx)("input",g({ref:t,type:r,checked:!!s.value,className:"rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:outline-none focus:ring disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-gray-200 ".concat(o||"")},s))}));h.displayName="CheckboxInput";const v=h,w=(0,r.forwardRef)((({field:e,fieldState:t,label:n,help:o,context:a,className:s,...i},l)=>{const d=i.id||e.name;return(0,r.createElement)(c.A,{label:n,help:o,error:t?.error?.message,context:a,className:s,inputId:d,required:i.required},(0,r.createElement)(v,{...e,id:d,type:"checkbox","aria-invalid":!!t?.error?.message,...i}))}));w.displayName="CheckboxField";const x=w;var k=n(6244),N=n(7723);const O={text:u,api:u,hidden:b,checkbox:x},E=(0,r.memo)((({setting:e,control:t,...n})=>{if(!1===e.visible)return(0,r.createElement)("input",{type:"hidden",defaultValue:e.value||e.default});const a=O[e.type];if(!a)return(0,r.createElement)("div",{className:"w-full"},"Unknown field type: ",e.type," ",e.id);const s={...e.required&&{required:{value:!0,message:e.requiredMessage||(0,N.__)("This field is required","simplybook")}},...e.validation?.regex&&{pattern:{value:new RegExp(e.validation.regex),message:e.validation.message||(0,N.__)("Invalid format","simplybook")}},...e.min&&{min:e.min},...e.max&&{max:e.max},...e.minLength&&{minLength:e.minLength},...e.maxLength&&{maxLength:e.maxLength},...e.validate&&{validate:e.validate}};return(0,r.createElement)(k.A,null,(0,r.createElement)(o.xI,{name:e.id,control:t,rules:s,defaultValue:e.value||e.default,render:({field:t,fieldState:o})=>(0,r.createElement)(a,{field:t,fieldState:o,required:e.required,label:e.label||e.id,disabled:n.settingsIsUpdating||e.disabled,context:e.context,help:e.help,options:e.options,...n})}))}));E.displayName="FormField";const j=E},5150:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(7665),o=n(9270),a=n(7097),s=n(6681);const i=()=>{const e=(0,r.jE)(),t=(0,o.I)({queryKey:["settings_fields"],queryFn:()=>(async({withValues:e=!0})=>(await(0,s.A)("settings/get_fields","POST",{withValues:e})).data)({withValues:!0}),staleTime:3e5,initialData:window.simplybook&&window.simplybook.settings_fields,retry:0,select:e=>[...e]}),{mutateAsync:n,isLoading:i}=(0,a.n)({mutationFn:async e=>(await new Promise((e=>setTimeout(e,1e3))),e),onSuccess:()=>{e.invalidateQueries(["settings_fields"])}});return{settings:t.data,saveSettings:n,getValue:e=>t.data.find((t=>t.id===e))?.value,setValue:(e,n)=>{const r=t.data.find((t=>t.id===e));r&&(r.value=n)},isSavingSettings:i,invalidateSettings:()=>e.invalidateQueries(["settings_fields"])}}},6905:(e,t,n)=>{n.d(t,{A:()=>a}),n(1609);var r=n(9270),o=n(3287);const a=()=>{const{settingsId:e}=o.Route.useParams(),t=(0,r.I)({queryKey:["settings_menu"],queryFn:()=>new Promise(((e,t)=>{window.simplybook&&window.simplybook.settings_menu&&e(window.simplybook.settings_menu),t(new Error("Settings menu not found"))})),initialData:window.simplybook&&window.simplybook.settings_menu,staleTime:3e5}),n=t.data.find((t=>t.id===e))||{};return{menu:t.data,currentForm:n,menuIsLoading:t.isLoading,menuIsError:t.isError}}},3287:(e,t,n)=>{n.r(t),n.d(t,{Route:()=>x});var r=n(1609),o=n(6037),a=n(5150),s=n(9785),i=n(6905),l=n(1243);const c=()=>{const[e,t]=(0,r.useState)(0);return(0,r.useEffect)((()=>{const e=()=>{const e=document.documentElement.scrollHeight-window.innerHeight;t(Math.round(window.scrollY/e*100))};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[]),document.documentElement.scrollHeight>window.innerHeight?(0,r.createElement)("div",{className:"h-1 w-full bg-gray-200"},(0,r.createElement)("div",{className:"h-full bg-blue-500",style:{width:`${Math.max(e,10)}%`}})):null};c.displayName="FormScrollProgressLine";const d=c;var u=n(8908),m=n(7723);function p({onSubmit:e,control:t}){const{isDirty:n,isSubmitting:o,isValidating:a,isValid:i,dirtyFields:l}=(0,s.lN)({control:t});return(0,r.createElement)("div",{className:"sticky z-10 rounded-b-md bg-gray-50 shadow-md"},(0,r.createElement)(d,null),(0,r.createElement)("div",{className:"flex flex-row justify-end p-5"},n&&(0,r.createElement)("p",null,(0,m.__)("You have unsaved changes","simplybook")),o&&(0,r.createElement)("p",null,(0,m.__)("Saving...","simplybook")),(0,r.createElement)(u.A,{onClick:e,disabled:o},(0,m.__)("Save","simplybook"))),"dirtyFields: ",JSON.stringify(l))}p.displayName="FormFooter";const f=p;var y=n(1674),b=n(7330),g=n(5071);const h=(0,r.memo)((({group:e,currentGroupFields:t,control:n,isLastGroup:o})=>{const a=o?"rounded-b-none":"mb-5";return(0,r.createElement)(y.A,{key:e.id,className:a},(0,r.createElement)(b.A,{title:e.title}),(0,r.createElement)(g.A,null,(0,r.createElement)("div",{className:"flex flex-wrap"},t.map((e=>(0,r.createElement)(l.A,{setting:e,key:e.id,control:n}))))))}));h.displayName="SettingsGroupBlock";const v=h;var w=n(396);const x=(0,o.uV)("/settings/$settingsId")({loader:({params:e})=>(e=>{const t=(window.simplybook?.settings_menu||[]).find((t=>t.id===e));if(!t)throw new Error("Settings not found");return{settingsData:t}})(e.settingsId),component:function(){const{settingsId:e}=x.useParams(),{settings:t,saveSettings:n}=(0,a.A)(),{currentForm:o}=(0,i.A)(),l=(0,r.useMemo)((()=>t.filter((t=>t.menu_id===e))),[t,e]),c=(0,r.useMemo)((()=>k(t,e)),[t,e]),d=(0,r.useMemo)((()=>k(t,e,"value")),[t,e]),u=(0,r.useMemo)((()=>o.groups[o.groups.length-1]),[o.groups]),{handleSubmit:m,control:p,reset:y,formState:{isDirty:b}}=(0,s.mN)({defaultValues:c,values:d});return function(e,t){const{blockerFn:n,blockerCondition:o}=e?"function"==typeof e?{blockerFn:e,blockerCondition:t??!0}:{blockerFn:e.blockerFn,blockerCondition:e.condition??!0}:{blockerFn:void 0,blockerCondition:t??!0},{history:a}=(0,w.r)(),[s,i]=r.useState({status:"idle",proceed:()=>{},reset:()=>{}});r.useEffect((()=>o?a.block((async()=>{if(n)return await n();const e=new Promise((e=>{i({status:"blocked",proceed:()=>e(!0),reset:()=>e(!1)})})),t=await e;return i({status:"idle",proceed:()=>{},reset:()=>{}}),t})):void 0),[n,o,a])}({blockerFn:()=>window.confirm("Are you sure you want to leave?"),condition:b}),(0,r.createElement)("form",null,o.groups?.map((e=>{const t=u.id===e.id,n=l.filter((t=>t.group_id===e.id));return(0,r.createElement)(v,{key:e.id,group:e,currentGroupFields:n,control:p,isLastGroup:t})})),(0,r.createElement)(f,{onSubmit:m((e=>{n(e).then((()=>{y(c)}))})),control:p}))}}),k=(e,t,n="default")=>{const r={};return e.forEach((e=>{e.menu_id===t&&(r[e.id]=e[n])})),r}}}]);