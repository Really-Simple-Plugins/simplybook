"use strict";(self.webpackChunksimplybook_app=self.webpackChunksimplybook_app||[]).push([[15],{1674:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(4848),o=r(1609),a=r(4164),l=(0,o.memo)((function(e){var t=e.className,r=void 0===t?"":t,o=e.children;return(0,n.jsx)("div",{className:(0,a.A)(r,"bg-white shadow-md rounded-xl flex flex-col"),children:o})}));l.displayName="Block";const s=l},9587:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(4848),o=r(5920),a=r(1609),l=r(7723),s=(0,a.memo)((function(e){var t=e.label,r=e.context,a=e.help,s=e.error,i=e.reverseLabel,c=void 0!==i&&i,d=e.className,u=void 0===d?"":d,m=e.inputId,p=e.required,f=void 0!==p&&p,b=e.children,g=["flex w-full flex-col",u,"pt-4"].filter(Boolean).join(" "),y=["flex w-full flex-col",c?"flex-col-reverse":""].filter(Boolean).join(" ");return(0,n.jsxs)("div",{className:g,children:[(0,n.jsxs)("div",{className:y,children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(o.b,{className:"cursor-pointer pb-1 font-medium text-black text-md",htmlFor:m,children:[t,f&&(0,n.jsxs)("span",{className:"ml-1 text-gray-500 font-normal text-xs",children:["(",(0,l.__)("Required","simplybook"),")"]})]}),a&&(0,n.jsx)("p",{className:"pb-1 text-xs font-light text-gray-600",children:a})]}),b]}),s&&(0,n.jsx)("p",{className:"mt-2 text-xs font-light text-red-600",role:"alert",children:s}),r&&(0,n.jsx)("p",{className:"mt-2 text-xs font-light text-gray-600",children:r})]})}));s.displayName="FieldWrapper";const i=s},8908:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(4848),o=r(3992),a=r(4164),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)},s=function(e){var t=e.children,r=e.onClick,s=e.link,i=e.btnVariant,c=void 0===i?"secondary":i,d=e.disabled,u=void 0!==d&&d,m=e.size,p=void 0===m?"md":m,f=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["children","onClick","link","btnVariant","disabled","size"]),b=(0,a.$)("rounded-full transition-all duration-200",{"bg-secondary text-white hover:bg-secondary-dark":"primary"===c,"bg-tertiary text-white hover:bg-tertiary-dark":"secondary"===c,"border-2 border-tertiary bg-transparent text-black hover:bg-tertiary-light":"tertiary"===c},{"py-.5 px-3 font-normal text-xs border-1":"sm"===p,"py-2 px-6 font-semibold":"md"===p,"py-3 px-8 text-lg font-semibold":"lg"===p},{"opacity-50 cursor-not-allowed":u});return s?(0,n.jsx)(o.N_,l({to:s.to,className:b},f,{children:t})):(0,n.jsx)("button",l({onClick:r,className:b,disabled:u},f,{children:t}))};s.displayName="ButtonInput";const i=s},5071:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(1609),o=r(4164);const a=({children:e,className:t=""})=>(0,n.createElement)("div",{className:(0,o.A)(t,"p-5 flex-grow")},e);a.displayName="BlockContent";const l=a},7330:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(1609),o=r(4164);const a=({title:e,controls:t,className:r=""})=>(0,n.createElement)("div",{className:(0,o.A)(r,"flex items-center justify-between px-5 py-4")},(0,n.createElement)("h2",{className:"text-base font-bold"},e),t);a.displayName="BlockHeading";const l=a},4829:(e,t,r)=>{r.d(t,{A:()=>G});var n=r(1609),o=r.n(n),a=r(9785),l=r(4848),s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},i=(0,n.forwardRef)((function(e,t){var r=e.type,n=void 0===r?"text":r,o=e.className,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["type","className"]);return(0,l.jsx)("input",s({ref:t,type:n,className:"w-full rounded-md border border-gray-300 p-2 focus:border-tertiary focus:outline-none focus:ring disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-gray-200 ".concat(o||"")},a))}));i.displayName="TextInput";const c=i;var d=r(9587),u=r(4441);const m=(0,n.forwardRef)((({setting:e,fieldState:t,label:r,help:o,context:a,className:l,...s},i)=>{const u=e.id;return(0,n.createElement)(d.A,{label:r,help:o,error:t?.error?.message,context:a,className:l,inputId:u,required:s.required},(0,n.createElement)(c,{id:u,type:"text","aria-invalid":!!t?.error?.message,...s}))}));m.displayName="TextField";const p=m;var f=function(){return f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},f.apply(this,arguments)},b=(0,n.forwardRef)((function(e,t){e.type,e.className;var r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["type","className"]);return(0,l.jsx)("input",f({ref:t,type:"hidden"},r))}));b.displayName="HiddenInput";const g=b,y=(0,n.forwardRef)((({setting:e,field:t,fieldState:r,label:o,help:a,context:l,className:s,...i},c)=>(0,n.createElement)(g,{...t,id:e.id,type:"hidden","aria-invalid":!!r?.error?.message,...i})));y.displayName="HiddenField";const h=y;var v=function(){return v=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},v.apply(this,arguments)},x=(0,n.forwardRef)((function(e,t){var r=e.type,o=void 0===r?"checkbox":r,a=e.className,s=e.value,i=e.onChange,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["type","className","value","onChange"]),d=(0,n.useState)(!1),u=d[0],m=d[1];return(0,n.useEffect)((function(){m("1"===s||1===s)}),[s]),(0,l.jsx)("input",v({checked:u,ref:t,onChange:function(e){i&&m(e.target.checked)},type:o,className:"rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:outline-none focus:ring disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-gray-200 ".concat(a||"")},c))}));x.displayName="CheckboxInput";const w=x,N=(0,n.forwardRef)((({setting:e,fieldState:t,label:r,help:o,context:a,className:l,...s},i)=>{const c=e.id;return(0,n.createElement)(d.A,{label:r,help:o,error:t?.error?.message,context:a,className:l,inputId:c,required:s.required},(0,n.createElement)(w,{id:c,type:"checkbox","aria-invalid":!!t?.error?.message,...s}))}));N.displayName="CheckboxField";const j=N;var k=r(3904),E=r(4164),O=function(){return O=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},O.apply(this,arguments)},S=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};const C=o().forwardRef((function(e,t){var r=e.value,n=e.onChange,o=e.options,a=void 0===o?[]:o;return e.setting,S(e,["value","onChange","options","setting"]),(0,l.jsxs)(k.bL,{value:r,onValueChange:function(e){return n(e)},children:[(0,l.jsxs)(k.l9,{ref:t,className:"flex w-full items-center justify-between rounded-md border border-gray-300 p-2 focus:border-tertiary focus:outline-none focus:ring",children:[(0,l.jsx)(k.WT,{placeholder:"Select an optionâ€¦"}),(0,l.jsx)(k.In,{className:"ml-2",children:"v"})]}),(0,l.jsx)(k.ZL,{children:(0,l.jsxs)(k.UC,{className:"rounded-md border border-gray-300 bg-white shadow-lg",children:[(0,l.jsx)(k.PP,{className:"flex items-center justify-center p-2"}),(0,l.jsx)(k.LM,{className:"p-2",children:a.map((function(e){return(0,l.jsx)(_,{value:e.value,children:e.label},e.value)}))}),(0,l.jsx)(k.wn,{className:"flex items-center justify-center p-2",children:"v"})]})})]})}));var _=o().forwardRef((function(e,t){var r=e.children,n=e.className,o=S(e,["children","className"]);return(0,l.jsxs)(k.q7,O({ref:t,className:(0,E.$)("flex cursor-pointer items-center justify-between rounded-md p-2 hover:bg-gray-100 focus:bg-gray-200",n)},o,{children:[(0,l.jsx)(k.p4,{children:r}),(0,l.jsx)(k.VF,{className:"ml-2",children:"v"})]}))}));r(2498);const P=(0,n.forwardRef)((({setting:e,fieldState:t,label:r,help:o,context:a,className:l,options:s,...i},c)=>{const u=e.id;return(0,n.createElement)(d.A,{label:r,help:o,error:t?.error?.message,context:a,className:l,inputId:u,required:i.required},(0,n.createElement)(C,{value:e.value,id:u,options:s,"aria-invalid":!!t?.error?.message,setting:e,...i}))}));P.displayName="SelectField";const A=P;var F=r(6244),I=r(7723),q=r(8394),L=(0,n.forwardRef)((function(e,t){var r=e.colorValue,o=void 0===r?"#ffffff":r,a=e.onChangeComplete,s=(0,n.useState)(o),i=s[0],c=s[1];return(0,l.jsx)("div",{ref:t,children:(0,l.jsx)(q.xk,{color:i,onChange:function(e){c(e.hex)},onChangeComplete:function(e){return null==a?void 0:a(e.hex)},disableAlpha:!0})})}));L.displayName="ColorPicker";const V=L;var R=r(4934);const M=(0,n.forwardRef)((({setting:e,fieldState:t,label:r,help:o,context:a,className:l,onChange:s,defaultValue:i,...c},u)=>{const m=e.value||e.default,[p,f]=(0,n.useState)(m);return(0,n.useEffect)((()=>{c.value!==p&&f(c.value)}),[c.value]),(0,n.createElement)(d.A,{label:"",help:o,error:t?.error?.message,context:a,className:l,inputId:e.id,required:c.required},(0,n.createElement)("div",{className:""},(0,n.createElement)((({label:e})=>(0,n.createElement)(R.bL,null,(0,n.createElement)(R.l9,{className:"p-[5px] mr-2 bg-transparent rounded-md border border-gray-400 min-w-[140px] text-sm"},(0,n.createElement)("div",{className:"cursor-pointer min-w-5 flex p-1.5 gap-3.5 items-center"},(0,n.createElement)("div",{className:"rounded-full min-w-5 h-5 border border-gray-300",style:{backgroundColor:p}}),e)),(0,n.createElement)(R.ZL,null,(0,n.createElement)(R.UC,null,(0,n.createElement)(V,{colorValue:p,onChangeComplete:(e,t)=>{f(e),s(e)}}))))),{setting:e,label:r})))}));M.displayName="ColorPickerField";const B={text:p,api:p,hidden:h,checkbox:j,select:A,colorpicker:M},H=(0,n.memo)((({setting:e,control:t,...r})=>{if(!1===e.visible)return(0,n.createElement)("input",{type:"hidden",defaultValue:e.value||e.default});const o=B[e.type],{saveSettings:l,setValue:s,getValue:i,settings:c}=(0,u.A)();if(!o)return(0,n.createElement)("div",{className:"w-full"},"Unknown field type: ",e.type," ",e.id);const d={...e.required&&{required:{value:!0,message:e.requiredMessage||(0,I.__)("This field is required","simplybook")}},...e.validation?.regex&&{pattern:{value:new RegExp(e.validation.regex),message:e.validation.message||(0,I.__)("Invalid format","simplybook")}},...e.min&&{min:e.min},...e.max&&{max:e.max},...e.minLength&&{minLength:e.minLength},...e.maxLength&&{maxLength:e.maxLength},...e.validate&&{validate:e.validate}};return(0,n.createElement)(F.A,null,(0,n.createElement)(a.xI,{name:e.id,control:t,rules:d,defaultValue:e.value||e.default,render:({field:t,fieldState:a})=>((0,n.useEffect)((()=>{i(e.id)!==t.value&&e.save_on_change&&t.value.length>0&&(async t=>{console.log("handleSaveOnChange",e.id,t,e.save_on_change),s(e.id,t),e.mapping&&e.mapping.forEach((e=>{s(e,t)})),console.log("saving formdata",c),await l(c)})(t.value)}),[t.value]),(0,n.createElement)(o,{className:e.inline_group?"inline-flex":"",setting:e,fieldState:a,required:e.required,label:e.label,disabled:r.settingsIsUpdating||e.disabled,context:e.context,help:e.help,options:e.options,...r,...t}))}))}));H.displayName="FormField";const G=H},6905:(e,t,r)=>{r.d(t,{A:()=>a}),r(1609);var n=r(9270),o=r(3287);const a=()=>{const{settingsId:e}=o.Route.useParams(),t=(0,n.I)({queryKey:["settings_menu"],queryFn:()=>new Promise(((e,t)=>{window.simplybook&&window.simplybook.settings_menu&&e(window.simplybook.settings_menu),t(new Error("Settings menu not found"))})),initialData:window.simplybook&&window.simplybook.settings_menu,staleTime:3e5}),r=t.data.find((t=>t.id===e))||{};return{menu:t.data,currentForm:r,menuIsLoading:t.isLoading,menuIsError:t.isError}}},3287:(e,t,r)=>{r.r(t),r.d(t,{Route:()=>w});var n=r(1609),o=r(6037),a=r(4441),l=r(9785),s=r(6905),i=r(4829);const c=()=>{const[e,t]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const e=()=>{const e=document.documentElement.scrollHeight-window.innerHeight;t(Math.round(window.scrollY/e*100))};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[]),document.documentElement.scrollHeight>window.innerHeight?(0,n.createElement)("div",{className:"h-1 w-full bg-gray-200"},(0,n.createElement)("div",{className:"h-full bg-blue-500",style:{width:`${Math.max(e,10)}%`}})):null};c.displayName="FormScrollProgressLine";const d=c;var u=r(8908),m=r(7723);function p({onSubmit:e,control:t}){const{isDirty:r,isSubmitting:o,isValidating:a,isValid:s}=(0,l.lN)({control:t}),i=[{condition:o,message:(0,m.__)("Saving...","simplybook"),color:"blue"},{condition:a,message:(0,m.__)("Validating...","simplybook"),color:"blue"},{condition:!s,message:(0,m.__)("Form contains errors","simplybook"),color:"red"},{condition:r,message:(0,m.__)("You have unsaved changes","simplybook"),color:"amber"}].find((e=>e.condition));return(0,n.createElement)("div",{className:"sticky bottom-0 start-0 z-10 rounded-b-md bg-gray-50 shadow-md"},(0,n.createElement)(d,null),(0,n.createElement)("div",{className:"flex flex-row justify-end gap-2 items-center p-5"},i&&(0,n.createElement)("p",{className:`text-sm text-${i.color}-500 flex items-center gap-2`},i.message),(0,n.createElement)(u.A,{onClick:e,disabled:o||a},(0,m.__)("Save","simplybook"))))}p.displayName="FormFooter";const f=p;var b=r(1674),g=r(7330),y=r(5071);const h=(0,n.memo)((({group:e,currentGroupFields:t,control:r,isLastGroup:o})=>{const a=o?"rounded-b-none":"mb-5";return(0,n.createElement)(b.A,{key:e.id,className:a},(0,n.createElement)(g.A,{title:e.title}),(0,n.createElement)(y.A,null,(0,n.createElement)("div",{className:"flex flex-wrap"},t.map((e=>(0,n.createElement)(i.A,{setting:e,key:e.id,control:r}))))))}));h.displayName="SettingsGroupBlock";const v=h;var x=r(396);const w=(0,o.uV)("/settings/$settingsId")({loader:({params:e})=>(e=>{const t=(window.simplybook?.settings_menu||[]).find((t=>t.id===e));if(!t)throw new Error("Settings not found");return{settingsData:t}})(e.settingsId),component:function(){const{settingsId:e}=w.useParams(),{settings:t,saveSettings:r}=(0,a.A)(),{currentForm:o}=(0,s.A)(),i=(0,n.useMemo)((()=>t.filter((t=>t.menu_id===e))),[t,e]),c=(0,n.useMemo)((()=>N(t,e)),[t,e]),d=(0,n.useMemo)((()=>N(t,e,"value")),[t,e]),u=(0,n.useMemo)((()=>o.groups[o.groups.length-1]),[o.groups]),{handleSubmit:m,control:p,reset:b,formState:{isDirty:g}}=(0,l.mN)({defaultValues:c,values:d});return function(e,t){const{blockerFn:r,blockerCondition:o}=e?"function"==typeof e?{blockerFn:e,blockerCondition:t??!0}:{blockerFn:e.blockerFn,blockerCondition:e.condition??!0}:{blockerFn:void 0,blockerCondition:t??!0},{history:a}=(0,x.r)(),[l,s]=n.useState({status:"idle",proceed:()=>{},reset:()=>{}});n.useEffect((()=>o?a.block((async()=>{if(r)return await r();const e=new Promise((e=>{s({status:"blocked",proceed:()=>e(!0),reset:()=>e(!1)})})),t=await e;return s({status:"idle",proceed:()=>{},reset:()=>{}}),t})):void 0),[r,o,a])}({blockerFn:()=>window.confirm("Are you sure you want to leave?"),condition:g}),(0,n.createElement)("form",null,o.groups?.map((e=>{const t=u.id===e.id,r=i.filter((t=>t.group_id===e.id));return(0,n.createElement)(v,{key:e.id,group:e,currentGroupFields:r,control:p,isLastGroup:t})})),(0,n.createElement)(f,{onSubmit:m((e=>{console.log("save settings",e),r(e).then((()=>{b(c)}))})),control:p}))}}),N=(e,t,r="default")=>{const n={};return e.forEach((e=>{e.menu_id===t&&(n[e.id]=e[r])})),n}}}]);