"use strict";(self.webpackChunksimplybook_app=self.webpackChunksimplybook_app||[]).push([[15],{1674:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(4848),o=r(1609),a=r(4164),l=(0,o.memo)((function(e){var t=e.className,r=void 0===t?"":t,o=e.children;return(0,n.jsx)("div",{className:(0,a.A)(r,"bg-white shadow-md rounded-xl flex flex-col"),children:o})}));l.displayName="Block";const i=l},9587:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(4848),o=r(640),a=r(1609),l=r(7723),i=(0,a.memo)((function(e){var t=e.label,r=e.context,a=e.help,i=e.error,s=e.reverseLabel,c=void 0!==s&&s,d=e.className,m=void 0===d?"":d,u=e.inputId,p=e.required,f=void 0!==p&&p,b=e.children,y=["flex w-full flex-col",m,"pt-4"].filter(Boolean).join(" "),g=["flex w-full flex-col",c?"flex-col-reverse":""].filter(Boolean).join(" ");return(0,n.jsxs)("div",{className:y,children:[(0,n.jsxs)("div",{className:g,children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(o.b,{className:"cursor-pointer pb-1 font-medium text-black text-md",htmlFor:u,children:[t,f&&(0,n.jsxs)("span",{className:"ml-1 text-gray-500 font-normal text-xs",children:["(",(0,l.__)("Required","simplybook"),")"]})]}),a&&(0,n.jsx)("p",{className:"pb-1 text-xs font-light text-gray-600",children:a})]}),b]}),i&&(0,n.jsx)("p",{className:"mt-2 text-xs font-light text-red-600",role:"alert",children:i}),r&&(0,n.jsx)("p",{className:"mt-2 text-xs font-light text-gray-600",children:r})]})}));i.displayName="FieldWrapper";const s=i},8908:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(4848),o=r(3992),a=r(4164),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)},i=function(e){var t=e.children,r=e.onClick,i=e.link,s=e.btnVariant,c=void 0===s?"secondary":s,d=e.disabled,m=void 0!==d&&d,u=e.size,p=void 0===u?"md":u,f=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["children","onClick","link","btnVariant","disabled","size"]),b=(0,a.$)("rounded-full transition-all duration-200",{"bg-secondary text-white hover:bg-secondary-dark":"primary"===c,"bg-tertiary text-white hover:bg-tertiary-dark":"secondary"===c,"border-2 border-tertiary bg-transparent text-black hover:bg-tertiary-light":"tertiary"===c},{"py-.5 px-3 font-normal text-xs border-1":"sm"===p,"py-2 px-6 font-semibold":"md"===p,"py-3 px-8 text-lg font-semibold":"lg"===p},{"opacity-50 cursor-not-allowed":m});return i?(0,n.jsx)(o.N_,l({to:i.to,className:b},f,{children:t})):(0,n.jsx)("button",l({onClick:r,className:b,disabled:m},f,{children:t}))};i.displayName="ButtonInput";const s=i},5071:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(1609),o=r(4164);const a=({children:e,className:t=""})=>(0,n.createElement)("div",{className:(0,o.A)(t,"p-5 flex-grow")},e);a.displayName="BlockContent";const l=a},7330:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(1609),o=r(4164);const a=({title:e,controls:t,className:r=""})=>(0,n.createElement)("div",{className:(0,o.A)(r,"flex items-center justify-between px-5 py-4")},(0,n.createElement)("h2",{className:"text-base font-bold"},e),t);a.displayName="BlockHeading";const l=a},1243:(e,t,r)=>{r.d(t,{A:()=>j});var n=r(1609),o=r(9785),a=r(4848),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)},i=(0,n.forwardRef)((function(e,t){var r=e.type,n=void 0===r?"text":r,o=e.className,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["type","className"]);return(0,a.jsx)("input",l({ref:t,type:n,className:"w-full rounded-md border border-gray-300 p-2 focus:border-tertiary focus:outline-none focus:ring disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-gray-200 ".concat(o||"")},i))}));i.displayName="TextInput";const s=i;var c=r(9587);r(5150);const d=(0,n.forwardRef)((({field:e,fieldState:t,label:r,help:o,context:a,className:l,...i},d)=>{const m=i.id||e.name;return(0,n.createElement)(c.A,{label:r,help:o,error:t?.error?.message,context:a,className:l,inputId:m,required:i.required},(0,n.createElement)(s,{id:m,type:"text","aria-invalid":!!t?.error?.message,...e,...i}))}));d.displayName="TextField";const m=d;var u=function(){return u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},u.apply(this,arguments)},p=(0,n.forwardRef)((function(e,t){e.type,e.className;var r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["type","className"]);return(0,a.jsx)("input",u({ref:t,type:"hidden"},r))}));p.displayName="HiddenInput";const f=p,b=(0,n.forwardRef)((({field:e,fieldState:t,label:r,help:o,context:a,className:l,...i},s)=>{const c=i.id||e.name;return(0,n.createElement)(f,{...e,id:c,type:"hidden","aria-invalid":!!t?.error?.message,...i})}));b.displayName="HiddenField";const y=b;var g=function(){return g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)},v=(0,n.forwardRef)((function(e,t){var r=e.type,n=void 0===r?"checkbox":r,o=e.className,l=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["type","className"]);return(0,a.jsx)("input",g({ref:t,type:n,className:"rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:outline-none focus:ring disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-gray-200 ".concat(o||"")},l))}));v.displayName="CheckboxInput";const h=v,x=(0,n.forwardRef)((({field:e,fieldState:t,label:r,help:o,context:a,className:l,...i},s)=>{const d=i.id||e.name;return(0,n.createElement)(c.A,{label:r,help:o,error:t?.error?.message,context:a,className:l,inputId:d,required:i.required},(0,n.createElement)(h,{...e,id:d,type:"checkbox","aria-invalid":!!t?.error?.message,...i}))}));x.displayName="CheckboxField";const w=x;var N=r(6244),k=r(7723);const O={text:m,api:m,hidden:y,checkbox:w},E=(0,n.memo)((({setting:e,control:t,...r})=>{if(!1===e.visible)return(0,n.createElement)("input",{type:"hidden",defaultValue:e.value||e.default});const a=O[e.type];if(!a)return(0,n.createElement)("div",{className:"w-full"},"Unknown field type: ",e.type," ",e.id);const l={...e.required&&{required:{value:!0,message:e.requiredMessage||(0,k.__)("This field is required","simplybook")}},...e.validation?.regex&&{pattern:{value:new RegExp(e.validation.regex),message:e.validation.message||(0,k.__)("Invalid format","simplybook")}},...e.min&&{min:e.min},...e.max&&{max:e.max},...e.minLength&&{minLength:e.minLength},...e.maxLength&&{maxLength:e.maxLength},...e.validate&&{validate:e.validate}};return(0,n.createElement)(N.A,null,(0,n.createElement)(o.xI,{name:e.id,control:t,rules:l,defaultValue:e.value||e.default,render:({field:t,fieldState:o})=>(0,n.createElement)(a,{field:t,fieldState:o,required:e.required,label:e.label||e.id,disabled:r.settingsIsUpdating||e.disabled,context:e.context,help:e.help,options:e.options,...r})}))}));E.displayName="FormField";const j=E},6905:(e,t,r)=>{r.d(t,{A:()=>a}),r(1609);var n=r(9270),o=r(3287);const a=()=>{const{settingsId:e}=o.Route.useParams(),t=(0,n.I)({queryKey:["settings_menu"],queryFn:()=>new Promise(((e,t)=>{window.simplybook&&window.simplybook.settings_menu&&e(window.simplybook.settings_menu),t(new Error("Settings menu not found"))})),initialData:window.simplybook&&window.simplybook.settings_menu,staleTime:3e5}),r=t.data.find((t=>t.id===e))||{};return{menu:t.data,currentForm:r,menuIsLoading:t.isLoading,menuIsError:t.isError}}},3287:(e,t,r)=>{r.r(t),r.d(t,{Route:()=>w});var n=r(1609),o=r(6037),a=r(5150),l=r(9785),i=r(6905),s=r(1243);const c=()=>{const[e,t]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const e=()=>{const e=document.documentElement.scrollHeight-window.innerHeight;t(Math.round(window.scrollY/e*100))};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[]),document.documentElement.scrollHeight>window.innerHeight?(0,n.createElement)("div",{className:"h-1 w-full bg-gray-200"},(0,n.createElement)("div",{className:"h-full bg-blue-500",style:{width:`${Math.max(e,10)}%`}})):null};c.displayName="FormScrollProgressLine";const d=c;var m=r(8908),u=r(7723);function p({onSubmit:e,control:t}){const{isDirty:r,isSubmitting:o,isValidating:a,isValid:i}=(0,l.lN)({control:t}),s=[{condition:o,message:(0,u.__)("Saving...","simplybook"),color:"blue"},{condition:a,message:(0,u.__)("Validating...","simplybook"),color:"blue"},{condition:!i,message:(0,u.__)("Form contains errors","simplybook"),color:"red"},{condition:r,message:(0,u.__)("You have unsaved changes","simplybook"),color:"amber"}].find((e=>e.condition));return(0,n.createElement)("div",{className:"sticky bottom-0 start-0 z-10 rounded-b-md bg-gray-50 shadow-md"},(0,n.createElement)(d,null),(0,n.createElement)("div",{className:"flex flex-row justify-end gap-2 items-center p-5"},s&&(0,n.createElement)("p",{className:`text-sm text-${s.color}-500 flex items-center gap-2`},s.message),(0,n.createElement)(m.A,{onClick:e,disabled:o||a},(0,u.__)("Save","simplybook"))))}p.displayName="FormFooter";const f=p;var b=r(1674),y=r(7330),g=r(5071);const v=(0,n.memo)((({group:e,currentGroupFields:t,control:r,isLastGroup:o})=>{const a=o?"rounded-b-none":"mb-5";return(0,n.createElement)(b.A,{key:e.id,className:a},(0,n.createElement)(y.A,{title:e.title}),(0,n.createElement)(g.A,null,(0,n.createElement)("div",{className:"flex flex-wrap"},t.map((e=>(0,n.createElement)(s.A,{setting:e,key:e.id,control:r}))))))}));v.displayName="SettingsGroupBlock";const h=v;var x=r(396);const w=(0,o.uV)("/settings/$settingsId")({loader:({params:e})=>(e=>{const t=(window.simplybook?.settings_menu||[]).find((t=>t.id===e));if(!t)throw new Error("Settings not found");return{settingsData:t}})(e.settingsId),component:function(){const{settingsId:e}=w.useParams(),{settings:t,saveSettings:r}=(0,a.A)(),{currentForm:o}=(0,i.A)(),s=(0,n.useMemo)((()=>t.filter((t=>t.menu_id===e))),[t,e]),c=(0,n.useMemo)((()=>N(t,e)),[t,e]),d=(0,n.useMemo)((()=>N(t,e,"value")),[t,e]),m=(0,n.useMemo)((()=>o.groups[o.groups.length-1]),[o.groups]),{handleSubmit:u,control:p,reset:b,formState:{isDirty:y}}=(0,l.mN)({defaultValues:c,values:d});return function(e,t){const{blockerFn:r,blockerCondition:o}=e?"function"==typeof e?{blockerFn:e,blockerCondition:t??!0}:{blockerFn:e.blockerFn,blockerCondition:e.condition??!0}:{blockerFn:void 0,blockerCondition:t??!0},{history:a}=(0,x.r)(),[l,i]=n.useState({status:"idle",proceed:()=>{},reset:()=>{}});n.useEffect((()=>o?a.block((async()=>{if(r)return await r();const e=new Promise((e=>{i({status:"blocked",proceed:()=>e(!0),reset:()=>e(!1)})})),t=await e;return i({status:"idle",proceed:()=>{},reset:()=>{}}),t})):void 0),[r,o,a])}({blockerFn:()=>window.confirm("Are you sure you want to leave?"),condition:y}),(0,n.createElement)("form",null,o.groups?.map((e=>{const t=m.id===e.id,r=s.filter((t=>t.group_id===e.id));return(0,n.createElement)(h,{key:e.id,group:e,currentGroupFields:r,control:p,isLastGroup:t})})),(0,n.createElement)(f,{onSubmit:u((e=>{r(e).then((()=>{b(c)}))})),control:p}))}}),N=(e,t,r="default")=>{const n={};return e.forEach((e=>{e.menu_id===t&&(n[e.id]=e[r])})),n}}}]);